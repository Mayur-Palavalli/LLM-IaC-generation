{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"DateMacroFunction": {"Type": "AWS::Lambda::Function", "Properties": {"Handler": "index.lambda_handler", "Runtime": "python3.9", "Role": {"Fn::GetAtt": ["LambdaExecutionRole", "Arn"]}, "Code": {"ZipFile": {"Fn::Join": ["\n", ["import json", "import datetime", "", "def lambda_handler(event, context):", "    operation = event['params']['operation']", "    if operation == 'current_date':", "        return current_date()", "    elif operation == 'add_days':", "        return add_days(event['params'])", "", "def current_date():", "    return datetime.datetime.utcnow().strftime('%Y-%m-%d')", "", "def add_days(params):", "    date_format = '%Y-%m-%d'", "    start_date = datetime.datetime.strptime(params['start_date'], date_format)", "    days_to_add = datetime.timedelta(days=params['days'])", "    new_date = start_date + days_to_add", "    return new_date.strftime(date_format)"]]}}}}, "LambdaExecutionRole": {"Type": "AWS::IAM::Role", "Properties": {"AssumeRolePolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}, "Policies": [{"PolicyName": "LambdaExecutionPolicy", "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents"], "Resource": "*"}]}}]}}, "DateMacro": {"Type": "AWS::CloudFormation::Macro", "Properties": {"Name": "DateMacro", "FunctionName": {"Ref": "DateMacroFunction"}, "LogGroupName": "/aws/lambda/DateMacro"}}}}