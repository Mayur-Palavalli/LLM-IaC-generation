{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to provision AWS Neptune Graph Database with CI/CD, CloudWatch, and SNS.", "Resources": {"NeptuneDBCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterIdentifier": "neptune-cluster", "Engine": "neptune", "BackupRetentionPeriod": 1, "Port": 8182, "PreferredBackupWindow": "03:00-04:00", "PreferredMaintenanceWindow": "sun:05:00-sun:06:00", "StorageEncrypted": true, "DBClusterParameterGroupName": {"Ref": "NeptuneDBClusterParameterGroup"}, "VpcSecurityGroupIds": [{"Ref": "NeptuneVPCSecurityGroup"}], "DBSubnetGroupName": {"Ref": "NeptuneDBSubnetGroup"}}}, "NeptuneDBInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": "db.r5.large", "DBClusterIdentifier": {"Ref": "NeptuneDBCluster"}, "AvailabilityZone": {"Fn::Select": [0, {"Fn::GetAZs": ""}]}}}, "NeptuneDBClusterParameterGroup": {"Type": "AWS::Neptune::DBClusterParameterGroup", "Properties": {"Description": "Cluster parameter group for Neptune", "Family": "neptune1", "Parameters": {"neptune-enable-audit-log": "1"}}}, "NeptuneDBSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for Neptune", "SubnetIds": ["subnet-xxxxxxxx", "subnet-yyyyyyyy"]}}, "NeptuneVPCSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Neptune security group", "VpcId": "vpc-zzzzzzzz", "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": 8182, "ToPort": 8182, "CidrIp": "0.0.0.0/0"}]}}, "CloudWatchAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmName": "NeptuneCPUUtilizationAlarm", "AlarmDescription": "Alarm for Neptune CPU Utilization", "Namespace": "AWS/Neptune", "MetricName": "CPUUtilization", "Dimensions": [{"Name": "DBClusterIdentifier", "Value": {"Ref": "NeptuneDBCluster"}}], "Statistic": "Average", "Period": 300, "EvaluationPeriods": 1, "Threshold": 80, "ComparisonOperator": "GreaterThanThreshold", "AlarmActions": [{"Ref": "SNSTopic"}]}}, "SNSTopic": {"Type": "AWS::SNS::Topic", "Properties": {"TopicName": "NeptuneAlarmsTopic"}}, "Pipeline": {"Type": "AWS::CodePipeline::Pipeline", "Properties": {"RoleArn": "arn:aws:iam::123456789012:role/CodePipelineServiceRole", "Stages": [{"Name": "Source", "Actions": [{"Name": "SourceAction", "ActionTypeId": {"Category": "Source", "Owner": "AWS", "Provider": "CodeCommit", "Version": "1"}, "Configuration": {"RepositoryName": "your-repo-name", "BranchName": "main"}, "OutputArtifacts": [{"Name": "SourceOutput"}]}]}, {"Name": "Deploy", "Actions": [{"Name": "DeployAction", "ActionTypeId": {"Category": "Deploy", "Owner": "AWS", "Provider": "CloudFormation", "Version": "1"}, "Configuration": {"ActionMode": "CREATE_UPDATE", "StackName": "NeptuneStack", "TemplatePath": "SourceOutput::template.yaml", "Capabilities": "CAPABILITY_IAM"}, "InputArtifacts": [{"Name": "SourceOutput"}]}]}], "ArtifactStore": {"Type": "S3", "Location": "your-s3-bucket"}}}}}