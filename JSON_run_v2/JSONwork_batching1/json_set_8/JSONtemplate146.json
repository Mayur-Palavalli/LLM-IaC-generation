{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"S3Bucket": {"Type": "AWS::S3::Bucket", "Properties": {"VersioningConfiguration": {"Status": "Enabled"}, "WebsiteConfiguration": {"IndexDocument": "index.html", "ErrorDocument": "error.html"}, "PublicAccessBlockConfiguration": {"BlockPublicAcls": true, "IgnorePublicAcls": true, "BlockPublicPolicy": true, "RestrictPublicBuckets": true}}}, "BucketPolicy": {"Type": "AWS::S3::BucketPolicy", "Properties": {"Bucket": {"Ref": "S3Bucket"}, "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": "*", "Action": "s3:GetObject", "Resource": {"Fn::Join": ["", ["arn:aws:s3:::", {"Ref": "S3Bucket"}, "/*"]]}, "Condition": {"StringEquals": {"aws:Referer": "http://example.com/"}}}]}}}, "OriginAccessIdentity": {"Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity", "Properties": {"CloudFrontOriginAccessIdentityConfig": {"Comment": "Access Identity for S3 Bucket"}}}, "CloudFrontDistribution": {"Type": "AWS::CloudFront::Distribution", "Properties": {"DistributionConfig": {"Enabled": true, "Origins": [{"DomainName": {"Fn::GetAtt": ["S3Bucket", "RegionalDomainName"]}, "Id": "S3Origin", "S3OriginConfig": {"OriginAccessIdentity": {"Fn::Join": ["", ["origin-access-identity/cloudfront/", {"Ref": "OriginAccessIdentity"}]]}}}], "DefaultCacheBehavior": {"TargetOriginId": "S3Origin", "ViewerProtocolPolicy": "redirect-to-https", "AllowedMethods": ["GET", "HEAD", "OPTIONS"], "Compress": true, "ForwardedValues": {"QueryString": false, "Cookies": {"Forward": "none"}}, "DefaultTTL": 86400, "MaxTTL": 31536000, "MinTTL": 0}, "ViewerCertificate": {"CloudFrontDefaultCertificate": true}}}}}, "Outputs": {"BucketName": {"Description": "Name of S3 bucket for website content", "Value": {"Ref": "S3Bucket"}}, "CloudFrontDomainName": {"Description": "Domain name of the CloudFront distribution", "Value": {"Fn::GetAtt": ["CloudFrontDistribution", "DomainName"]}}}}