{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"MainBucket": {"Type": "AWS::S3::Bucket", "Properties": {"BucketEncryption": {"ServerSideEncryptionConfiguration": [{"ServerSideEncryptionByDefault": {"SSEAlgorithm": "AES256"}}]}, "PublicAccessBlockConfiguration": {"BlockPublicAcls": true, "IgnorePublicAcls": true, "BlockPublicPolicy": true, "RestrictPublicBuckets": true}}}, "ReplicaBucket": {"Type": "AWS::S3::Bucket", "Properties": {"BucketEncryption": {"ServerSideEncryptionConfiguration": [{"ServerSideEncryptionByDefault": {"SSEAlgorithm": "AES256"}}]}, "PublicAccessBlockConfiguration": {"BlockPublicAcls": true, "IgnorePublicAcls": true, "BlockPublicPolicy": true, "RestrictPublicBuckets": true}}}, "AccessLogBucket": {"Type": "AWS::S3::Bucket", "Properties": {"BucketEncryption": {"ServerSideEncryptionConfiguration": [{"ServerSideEncryptionByDefault": {"SSEAlgorithm": "AES256"}}]}, "PublicAccessBlockConfiguration": {"BlockPublicAcls": true, "IgnorePublicAcls": true, "BlockPublicPolicy": true, "RestrictPublicBuckets": true}}}, "MainBucketPolicy": {"Type": "AWS::S3::BucketPolicy", "Properties": {"Bucket": {"Ref": "MainBucket"}, "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Deny", "Principal": "*", "Action": "s3:*", "Resource": [{"Fn::GetAtt": ["MainBucket", "Arn"]}, {"Fn::Join": ["/", [{"Fn::GetAtt": ["MainBucket", "Arn"]}, "*"]]}], "Condition": {"Bool": {"aws:SecureTransport": "false"}}}]}}}}, "Outputs": {"MainBucketName": {"Value": {"Ref": "MainBucket"}}, "ReplicaBucketName": {"Value": {"Ref": "ReplicaBucket"}}, "AccessLogBucketName": {"Value": {"Ref": "AccessLogBucket"}}}}