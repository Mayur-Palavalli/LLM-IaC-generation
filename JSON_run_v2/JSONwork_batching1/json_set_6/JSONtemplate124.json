{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to provision AWS Neptune, CloudWatch, and SNS for optimized CI/CD", "Parameters": {"NeptuneClusterIdentifier": {"Type": "String", "Default": "my-neptune-cluster", "Description": "Neptune DB Cluster Identifier"}, "NeptuneInstanceType": {"Type": "String", "Default": "db.r5.large", "Description": "Neptune DB Instance Type"}, "SNSTopicName": {"Type": "String", "Default": "NeptuneAlertTopic", "Description": "SNS Topic for Neptune Alerts"}, "SubnetIds": {"Type": "List<AWS::EC2::Subnet::Id>", "Description": "The list of Subnet IDs for the Neptune Subnet Group"}}, "Resources": {"NeptuneSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for Neptune cluster", "SubnetIds": {"Ref": "SubnetIds"}}}, "NeptuneCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterIdentifier": {"Ref": "NeptuneClusterIdentifier"}, "DBSubnetGroupName": {"Ref": "NeptuneSubnetGroup"}, "EngineVersion": "1.0.4.2", "StorageEncrypted": true, "BackupRetentionPeriod": 7, "AvailabilityZones": {"Fn::GetAZs": ""}}}, "NeptuneInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": {"Ref": "NeptuneInstanceType"}, "DBClusterIdentifier": {"Ref": "NeptuneClusterIdentifier"}, "AvailabilityZone": {"Fn::Select": ["0", {"Fn::GetAZs": ""}]}}}, "NeptuneAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmName": "NeptuneCPUUtilizationAlarm", "MetricName": "CPUUtilization", "Namespace": "AWS/Neptune", "Statistic": "Average", "Period": "60", "EvaluationPeriods": "5", "Threshold": "80", "ComparisonOperator": "GreaterThanThreshold", "Dimensions": [{"Name": "DBClusterIdentifier", "Value": {"Ref": "NeptuneClusterIdentifier"}}], "AlarmActions": [{"Ref": "SNSTopic"}]}}, "SNSTopic": {"Type": "AWS::SNS::Topic", "Properties": {"TopicName": {"Ref": "SNSTopicName"}}}}, "Outputs": {"NeptuneClusterEndpoint": {"Description": "Endpoint of the Neptune Cluster", "Value": {"Fn::GetAtt": ["NeptuneCluster", "Endpoint"]}}, "NeptuneReaderEndpoint": {"Description": "Reader endpoint of the Neptune Cluster", "Value": {"Fn::GetAtt": ["NeptuneCluster", "ReadEndpoint"]}}, "SNSTopicARN": {"Description": "ARN of the SNS Topic", "Value": {"Ref": "SNSTopic"}}}}