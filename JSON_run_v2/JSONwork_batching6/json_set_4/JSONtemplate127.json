{"AWSTemplateFormatVersion": "2010-09-09", "Description": "Highly available RDS DBInstance with a read replica.", "Resources": {"MyDBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"AllocatedStorage": "20", "DBInstanceClass": "db.t2.micro", "Engine": "mysql", "MasterUsername": "admin", "MasterUserPassword": {"Fn::Sub": "{{resolve:ssm-secure:DBMasterPassword:1}}"}, "DBSubnetGroupName": {"Ref": "MyDBSubnetGroup"}, "VPCSecurityGroups": [{"Fn::GetAtt": ["MyDBSecurityGroup", "GroupId"]}], "MultiAZ": true}}, "MyReadReplica": {"Type": "AWS::RDS::DBInstance", "Properties": {"SourceDBInstanceIdentifier": {"Ref": "MyDBInstance"}, "DBInstanceClass": "db.t2.micro", "DBSubnetGroupName": {"Ref": "MyDBSubnetGroup"}, "VPCSecurityGroups": [{"Fn::GetAtt": ["MyDBSecurityGroup", "GroupId"]}]}}, "MyDBSubnetGroup": {"Type": "AWS::RDS::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for RDS DBInstance", "SubnetIds": ["subnet-12345678", "subnet-87654321"]}}, "MyDBSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for RDS DBInstance", "VpcId": "vpc-12345678", "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": "3306", "ToPort": "3306", "CidrIp": "0.0.0.0/0"}]}}}, "Parameters": {"DBMasterPassword": {"NoEcho": true, "Description": "Password for the RDS DB Instance", "Type": "String", "MinLength": 8, "MaxLength": 41, "AllowedPattern": "[a-zA-Z0-9]*", "ConstraintDescription": "must contain only alphanumeric characters."}}}