{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template for AD Connector with optional seamless domain join, security group, and DHCP option set.", "Parameters": {"ConnectorDnsIpAddresses": {"Type": "List<String>", "Description": "DNS IP addresses for the AD Connector."}, "CustomerDnsIpAddresses": {"Type": "List<String>", "Description": "DNS IP addresses for the on-premises AD."}, "CustomerDomainName": {"Type": "String", "Description": "Domain name for the on-premises AD."}, "Password": {"Type": "String", "Description": "Password for AD Connector", "NoEcho": true}, "VpcId": {"Type": "AWS::EC2::VPC::Id", "Description": "The VPC ID where the resources will be created."}, "SubnetIds": {"Type": "List<AWS::EC2::Subnet::Id>", "Description": "List of subnet IDs where the resources will be created."}}, "Resources": {"ADConnector": {"Type": "AWS::DirectoryService::SimpleAD", "Properties": {"Name": {"Ref": "CustomerDomainName"}, "Password": {"Ref": "Password"}, "Size": "Small", "VpcSettings": {"VpcId": {"Ref": "VpcId"}, "SubnetIds": {"Ref": "SubnetIds"}}}}, "DomainMembersSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Allow all PrivateIP communications inbound within the domain.", "VpcId": {"Ref": "VpcId"}, "SecurityGroupIngress": [{"IpProtocol": "-1", "CidrIp": "10.0.0.0/16"}]}}, "DHCPOptions": {"Type": "AWS::EC2::DHCPOptions", "Properties": {"DomainNameServers": {"Ref": "CustomerDnsIpAddresses"}}}, "DHCPOptionsAssociation": {"Type": "AWS::EC2::VPCDHCPOptionsAssociation", "Properties": {"DhcpOptionsId": {"Ref": "DHCPOptions"}, "VpcId": {"Ref": "VpcId"}}}}, "Outputs": {"ADConnectorId": {"Description": "The AD Connector ID", "Value": {"Ref": "ADConnector"}}, "DomainMembersSecurityGroupId": {"Description": "The security group ID for domain members", "Value": {"Ref": "DomainMembersSecurityGroup"}}, "DHCPOptionsId": {"Description": "The DHCP Options set ID", "Value": {"Ref": "DHCPOptions"}}}}