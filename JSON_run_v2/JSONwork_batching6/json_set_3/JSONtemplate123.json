{"AWSTemplateFormatVersion": "2010-09-09", "Parameters": {}, "Resources": {"NeptuneCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterIdentifier": "my-neptune-cluster", "BackupRetentionPeriod": 5, "PreferredBackupWindow": "02:00-03:00", "PreferredMaintenanceWindow": "sun:05:00-sun:06:00", "StorageEncrypted": true, "VpcSecurityGroupIds": [{"Ref": "NeptuneSecurityGroup"}], "DBSubnetGroupName": {"Ref": "NeptuneSubnetGroup"}}}, "NeptuneInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": "db.r5.large", "DBClusterIdentifier": {"Ref": "NeptuneCluster"}, "AvailabilityZone": {"Fn::Select": [0, {"Fn::GetAZs": ""}]}}}, "NeptuneSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for Neptune cluster", "VpcId": {"Ref": "VpcId"}, "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": 8182, "ToPort": 8182, "CidrIp": "0.0.0.0/0"}]}}, "NeptuneSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for Neptune cluster", "SubnetIds": ["subnet-0example1", "subnet-0example2"]}}, "CloudWatchAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmDescription": "Alarm if Neptune DB CPU utilization is too high", "Namespace": "AWS/Neptune", "MetricName": "CPUUtilization", "Statistic": "Average", "Period": 300, "EvaluationPeriods": 1, "Threshold": 80, "ComparisonOperator": "GreaterThanThreshold", "AlarmActions": [{"Ref": "SNSTopic"}]}}, "SNSTopic": {"Type": "AWS::SNS::Topic", "Properties": {"TopicName": "NeptuneAlarmTopic"}}, "SNSSubscription": {"Type": "AWS::SNS::Subscription", "Properties": {"TopicArn": {"Ref": "SNSTopic"}, "Protocol": "email", "Endpoint": "alert@example.com"}}}, "Outputs": {"NeptuneClusterEndpoint": {"Description": "Endpoint for the Neptune cluster", "Value": {"Fn::GetAtt": ["NeptuneCluster", "Endpoint"]}}}}