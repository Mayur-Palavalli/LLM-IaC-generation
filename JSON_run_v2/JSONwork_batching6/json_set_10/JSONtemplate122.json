{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"NeptuneCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterIdentifier": "my-neptune-cluster", "BackupRetentionPeriod": 7, "PreferredBackupWindow": "07:00-09:00", "PreferredMaintenanceWindow": "Mon:00:00-Mon:03:00", "StorageEncrypted": true}}, "NeptuneInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": "db.r5.large", "DBClusterIdentifier": {"Ref": "NeptuneCluster"}, "DBInstanceIdentifier": "my-neptune-instance"}}, "NeptuneCWAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmName": "NeptuneCPUUtilizationAlarm", "AlarmDescription": "Alarm for Neptune DB instance CPU utilization", "Namespace": "AWS/Neptune", "MetricName": "CPUUtilization", "Dimensions": [{"Name": "DBInstanceIdentifier", "Value": {"Ref": "NeptuneInstance"}}], "Statistic": "Average", "Period": 300, "EvaluationPeriods": 1, "Threshold": 80, "ComparisonOperator": "GreaterThanOrEqualToThreshold", "AlarmActions": [{"Ref": "NeptuneSNS"}], "OKActions": [{"Ref": "NeptuneSNS"}]}}, "NeptuneSNS": {"Type": "AWS::SNS::Topic", "Properties": {"TopicName": "neptune-alerts"}}, "SNSTopicPolicy": {"Type": "AWS::SNS::TopicPolicy", "Properties": {"Topics": [{"Ref": "NeptuneSNS"}], "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"AWS": "*"}, "Action": "SNS:Publish", "Resource": {"Ref": "NeptuneSNS"}, "Condition": {"ArnEquals": {"aws:SourceArn": "*"}}}]}}}}, "Outputs": {"NeptuneClusterEndpoint": {"Description": "Endpoint for the Neptune DB Cluster", "Value": {"Fn::GetAtt": ["NeptuneCluster", "Endpoint"]}}, "NeptuneReaderEndpoint": {"Description": "Reader endpoint for the Neptune DB Cluster", "Value": {"Fn::GetAtt": ["NeptuneCluster", "ReadEndpoint"]}}}}