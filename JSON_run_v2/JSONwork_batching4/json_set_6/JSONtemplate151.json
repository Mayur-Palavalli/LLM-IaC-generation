{"AWSTemplateFormatVersion": "2010-09-09", "Parameters": {"VpcId": {"Type": "AWS::EC2::VPC::Id", "Description": "VPC ID"}, "SubnetIds": {"Type": "List<AWS::EC2::Subnet::Id>", "Description": "List of Subnet IDs"}, "DnsIpAddresses": {"Type": "CommaDelimitedList", "Description": "List of DNS IP Addresses from the on-premises AD"}, "DomainName": {"Type": "String", "Description": "The fully qualified name of the on-premises domain"}, "AdConnectorName": {"Type": "String", "Description": "The name of the AD Connector"}, "SecurePassword": {"Type": "AWS::SecretsManager::Secret", "Description": "The password for AD Connector"}}, "Resources": {"ADConnector": {"Type": "AWS::DirectoryService::MicrosoftAD", "Properties": {"Name": {"Ref": "AdConnectorName"}, "Password": {"Ref": "SecurePassword"}, "Description": "AD Connector for on-premises domain", "ShortName": {"Ref": "DomainName"}, "VpcSettings": {"SubnetIds": {"Fn::Split": [",", {"Ref": "SubnetIds"}]}, "VpcId": {"Ref": "VpcId"}}}}, "DomainMembersSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for domain member communication", "VpcId": {"Ref": "VpcId"}, "SecurityGroupIngress": [{"IpProtocol": "-1", "CidrIp": "0.0.0.0/0"}]}}, "DHCPOptionsSet": {"Type": "AWS::EC2::DHCPOptions", "Properties": {"DomainName": {"Ref": "DomainName"}, "DomainNameServers": {"Fn::Split": [",", {"Fn::Join": [",", {"Ref": "DnsIpAddresses"}]}]}}}, "DHCPOptionsAssociation": {"Type": "AWS::EC2::VPCDHCPOptionsAssociation", "Properties": {"DhcpOptionsId": {"Ref": "DHCPOptionsSet"}, "VpcId": {"Ref": "VpcId"}}}}, "Metadata": {"AWS::CloudFormation::Interface": {"ParameterGroups": [{"Label": {"default": "Network Configuration"}, "Parameters": ["VpcId", "SubnetIds", "DnsIpAddresses", "DomainName"]}, {"Label": {"default": "AD Connector Configuration"}, "Parameters": ["AdConnectorName", "SecurePassword"]}], "ParameterLabels": {"VpcId": {"default": "VPC ID"}, "SubnetIds": {"default": "Subnet IDs"}, "DnsIpAddresses": {"default": "DNS IP Addresses"}, "DomainName": {"default": "Domain Name"}, "AdConnectorName": {"default": "AD Connector Name"}, "SecurePassword": {"default": "AD Connector Password"}}}}}