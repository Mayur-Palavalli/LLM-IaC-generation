{"AWSTemplateFormatVersion": "2010-09-09", "Description": "Highly-available RDS DBInstance with a read replica.", "Resources": {"RDSDBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceIdentifier": "primary-db-instance", "AllocatedStorage": "20", "DBInstanceClass": "db.m5.large", "Engine": "mysql", "MasterUsername": "admin", "MasterUserPassword": {"Ref": "DBMasterUserPassword"}, "DBName": "mydatabase", "BackupRetentionPeriod": 7, "MultiAZ": true, "PubliclyAccessible": false, "StorageType": "gp2", "VPCSecurityGroups": [{"Ref": "DBSecurityGroup"}], "DBSubnetGroupName": {"Ref": "DBSubnetGroup"}}}, "RDSReadReplica": {"Type": "AWS::RDS::DBInstance", "Properties": {"SourceDBInstanceIdentifier": {"Ref": "RDSDBInstance"}, "DBInstanceClass": "db.m5.large", "DBSubnetGroupName": {"Ref": "DBSubnetGroup"}, "VPCSecurityGroups": [{"Ref": "DBSecurityGroup"}], "PubliclyAccessible": false, "StorageType": "gp2"}}, "DBMasterUserPassword": {"Type": "AWS::SSM::Parameter", "Properties": {"Name": "DBMasterUserPassword", "Type": "String", "Value": "strongpassword123"}}, "DBSubnetGroup": {"Type": "AWS::RDS::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for RDS DB instance", "SubnetIds": ["subnet-abc123456", "subnet-def789012"]}}, "DBSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for RDS DB instances", "VpcId": {"Ref": "MyVPC"}, "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": 3306, "ToPort": 3306, "CidrIp": "10.0.0.0/16"}]}}, "MyVPC": {"Type": "AWS::EC2::VPC", "Properties": {"CidrBlock": "10.0.0.0/16"}}}, "Outputs": {"PrimaryDBInstanceEndpoint": {"Description": "Endpoint for the primary RDS DB instance", "Value": {"Fn::GetAtt": ["RDSDBInstance", "Endpoint.Address"]}}, "ReadReplicaEndpoint": {"Description": "Endpoint for the read replica RDS DB instance", "Value": {"Fn::GetAtt": ["RDSReadReplica", "Endpoint.Address"]}}}}