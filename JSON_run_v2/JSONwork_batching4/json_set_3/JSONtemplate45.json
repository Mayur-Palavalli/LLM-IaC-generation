{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"AuroraCluster": {"Type": "AWS::RDS::DBCluster", "Properties": {"Engine": "aurora-mysql", "MasterUsername": "admin", "MasterUserPassword": {"Fn::Sub": "{{resolve:secretsmanager:MasterUserPassword:SecretString:password}}"}, "DBSubnetGroupName": {"Ref": "DBSubnetGroup"}, "VpcSecurityGroupIds": [{"Ref": "DBSecurityGroup"}]}}, "DBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBClusterIdentifier": {"Ref": "AuroraCluster"}, "DBInstanceClass": "db.r5.large"}}, "DBSubnetGroup": {"Type": "AWS::RDS::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for Aurora RDS", "SubnetIds": ["subnet-12345678", "subnet-87654321"]}}, "DBSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for Aurora RDS", "VpcId": "vpc-abcdef12"}}, "DMSInstance": {"Type": "AWS::DMS::ReplicationInstance", "Properties": {"ReplicationInstanceClass": "dms.r5.large", "VpcSecurityGroupIds": [{"Ref": "DBSecurityGroup"}], "ReplicationSubnetGroupIdentifier": {"Ref": "ReplicationSubnetGroup"}}}, "ReplicationSubnetGroup": {"Type": "AWS::DMS::ReplicationSubnetGroup", "Properties": {"ReplicationSubnetGroupDescription": "Replication Subnet Group", "SubnetIds": ["subnet-12345678", "subnet-87654321"]}}, "S3Bucket": {"Type": "AWS::S3::Bucket"}, "DMSSourceEndpoint": {"Type": "AWS::DMS::Endpoint", "Properties": {"EndpointIdentifier": "aurora-source-endpoint", "EndpointType": "source", "EngineName": "aurora", "Username": "admin", "Password": {"Fn::Sub": "{{resolve:secretsmanager:DMSSourceEndpointPassword:SecretString:password}}"}, "ServerName": {"Fn::GetAtt": ["AuroraCluster", "Endpoint.Address"]}, "Port": 3306, "DatabaseName": "mydatabase"}}, "DMSTargetEndpoint": {"Type": "AWS::DMS::Endpoint", "Properties": {"EndpointIdentifier": "s3-target-endpoint", "EndpointType": "target", "EngineName": "s3"}}, "DMSTask": {"Type": "AWS::DMS::ReplicationTask", "Properties": {"MigrationType": "full-load-and-cdc", "ReplicationInstanceArn": {"Ref": "DMSInstance"}, "SourceEndpointArn": {"Ref": "DMSSourceEndpoint"}, "TargetEndpointArn": {"Ref": "DMSTargetEndpoint"}, "TableMappings": "{\"TableMappings\":[]}", "ReplicationTaskSettings": "{}"}}}, "Parameters": {"MasterUserPassword": {"Type": "String", "NoEcho": true}, "DMSSourceEndpointPassword": {"Type": "String", "NoEcho": true}}}