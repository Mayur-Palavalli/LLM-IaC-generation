{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"MyFileSystem": {"Type": "AWS::EFS::FileSystem", "Properties": {"BackupPolicy": {"Status": "ENABLED"}, "LifecyclePolicies": [{"TransitionToIA": "AFTER_30_DAYS"}], "PerformanceMode": "generalPurpose", "ThroughputMode": "bursting"}}, "MyMountTarget1A": {"Type": "AWS::EFS::MountTarget", "Properties": {"FileSystemId": {"Ref": "MyFileSystem"}, "SubnetId": {"Fn::Select": ["0", {"Fn::GetAZs": {"Ref": "AWS::Region"}}]}, "SecurityGroups": [{"Ref": "MyEFSSecurityGroup"}]}}, "MyMountTarget1B": {"Type": "AWS::EFS::MountTarget", "Properties": {"FileSystemId": {"Ref": "MyFileSystem"}, "SubnetId": {"Fn::Select": ["1", {"Fn::GetAZs": {"Ref": "AWS::Region"}}]}, "SecurityGroups": [{"Ref": "MyEFSSecurityGroup"}]}}, "MyEFSSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Allow access to EFS", "VpcId": {"Ref": "MyVPC"}, "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": "2049", "ToPort": "2049", "CidrIp": "0.0.0.0/0"}]}}, "MyMountCommandScript": {"Type": "AWS::CloudFormation::Init", "Metadata": {"AWS::CloudFormation::Init": {"config": {"files": {"/etc/fstab": {"content": {"Fn::Join": ["", ["fs-", {"Ref": "MyFileSystem"}, ".efs.", {"Ref": "AWS::Region"}, ".amazonaws.com:/ ", " /mnt/efs efs defaults,_netdev"]]}, "mode": "000644", "owner": "root", "group": "root"}, "/mnt/efs": {"content": "", "mode": "000755", "owner": "root", "group": "root"}}, "commands": {"createEFSMountDirectory": {"command": "mkdir -p /mnt/efs"}, "mountEFS": {"command": "mount -a"}}}}}}}, "Outputs": {"FileSystemId": {"Value": {"Ref": "MyFileSystem"}}, "FileSystemDNSName": {"Value": {"Fn::GetAtt": ["MyFileSystem", "DnsName"]}}}}