{"AWSTemplateFormatVersion": "2010-09-09", "Parameters": {"DBClusterIdentifier": {"Type": "String", "Description": "Neptune DB Cluster Identifier"}, "InstanceType": {"Type": "String", "Default": "db.r5.large", "AllowedValues": ["db.r5.large", "db.r5.xlarge", "db.r5.2xlarge", "db.r5.4xlarge", "db.r5.12xlarge", "db.r5.24xlarge"], "Description": "Neptune Instance Type"}, "SubnetIds": {"Type": "List<AWS::EC2::Subnet::Id>", "Description": "List of Subnet IDs for the Neptune cluster"}, "SecurityGroupIds": {"Type": "List<AWS::EC2::SecurityGroup::Id>", "Description": "List of Security Group IDs for the Neptune cluster"}, "SNSTopicArn": {"Type": "String", "Description": "SNS Topic ARN for notifications"}}, "Resources": {"NeptuneDBCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterIdentifier": {"Ref": "DBClusterIdentifier"}, "VpcSecurityGroupIds": {"Fn::Split": [",", {"Ref": "SecurityGroupIds"}]}, "DBSubnetGroupName": {"Ref": "NeptuneDBSubnetGroup"}, "AvailabilityZones": {"Fn::GetAZs": ""}}}, "NeptuneDBInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": {"Ref": "InstanceType"}, "DBClusterIdentifier": {"Ref": "DBClusterIdentifier"}}}, "NeptuneDBSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for the Neptune DB cluster", "SubnetIds": {"Ref": "SubnetIds"}}}, "NeptuneCloudWatchAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmDescription": "Alarm for Neptune service health", "MetricName": "CPUUtilization", "Namespace": "AWS/Neptune", "Statistic": "Average", "Period": 300, "EvaluationPeriods": 1, "Threshold": 80, "ComparisonOperator": "GreaterThanOrEqualToThreshold", "Dimensions": [{"Name": "DBClusterIdentifier", "Value": {"Ref": "DBClusterIdentifier"}}], "AlarmActions": [{"Ref": "SNSTopicArn"}]}}}, "Outputs": {"NeptuneClusterEndpoint": {"Description": "Endpoint for the Neptune cluster", "Value": {"Fn::GetAtt": ["NeptuneDBCluster", "Endpoint"]}}, "NeptuneReaderEndpoint": {"Description": "Reader endpoint for the Neptune cluster", "Value": {"Fn::GetAtt": ["NeptuneDBCluster", "ReadEndpoint"]}}}}