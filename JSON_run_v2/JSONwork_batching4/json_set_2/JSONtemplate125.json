{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"NeptuneClusterParameterGroup": {"Type": "AWS::Neptune::DBClusterParameterGroup", "Properties": {"Description": "Cluster parameter group for Neptune", "Family": "neptune1", "Parameters": {"neptune_enable_audit_log": "1", "neptune_query_timeout": "10000"}}}, "NeptuneDBCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterParameterGroupName": {"Ref": "NeptuneClusterParameterGroup"}, "DBSubnetGroupName": {"Ref": "NeptuneDBSubnetGroup"}, "VpcSecurityGroupIds": [{"Ref": "NeptuneSecurityGroup"}], "BackupRetentionPeriod": 7, "PreferredBackupWindow": "07:00-09:00", "PreferredMaintenanceWindow": "sun:23:00-mon:01:30"}}, "NeptuneDBInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": "db.r5.large", "DBClusterIdentifier": {"Ref": "NeptuneDBCluster"}, "AutoMinorVersionUpgrade": true}}, "NeptuneDBSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for Neptune", "SubnetIds": ["subnet-12345678", "subnet-abcdef12"]}}, "NeptuneSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for Neptune", "VpcId": "vpc-12ab34cd"}}, "CloudWatchAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmDescription": "Alarm if Neptune CPU exceeds 80%", "MetricName": "CPUUtilization", "Namespace": "AWS/Neptune", "Statistic": "Average", "Period": 300, "EvaluationPeriods": 1, "Threshold": 80, "ComparisonOperator": "GreaterThanOrEqualToThreshold", "Dimensions": [{"Name": "DBClusterIdentifier", "Value": {"Ref": "NeptuneDBCluster"}}], "AlarmActions": [{"Ref": "SNSTopic"}]}}, "SNSTopic": {"Type": "AWS::SNS::Topic", "Properties": {"DisplayName": "NeptuneCloudWatchTopic"}}, "CodePipeline": {"Type": "AWS::CodePipeline::Pipeline", "Properties": {"RoleArn": "arn:aws:iam::123456789012:role/CodePipelineServiceRole", "Stages": [{"Name": "Source", "Actions": [{"Name": "SourceStage", "ActionTypeId": {"Category": "Source", "Owner": "AWS", "Provider": "CodeCommit", "Version": "1"}, "OutputArtifacts": [{"Name": "SourceOutput"}], "Configuration": {"BranchName": "main", "RepositoryName": "MyRepository"}}]}, {"Name": "Build", "Actions": [{"Name": "BuildStage", "ActionTypeId": {"Category": "Build", "Owner": "AWS", "Provider": "CodeBuild", "Version": "1"}, "InputArtifacts": [{"Name": "SourceOutput"}], "OutputArtifacts": [{"Name": "BuildOutput"}], "Configuration": {"ProjectName": "MyBuildProject"}}]}, {"Name": "Deploy", "Actions": [{"Name": "DeployStage", "ActionTypeId": {"Category": "Deploy", "Owner": "AWS", "Provider": "CloudFormation", "Version": "1"}, "InputArtifacts": [{"Name": "BuildOutput"}], "Configuration": {"ActionMode": "CHANGE_SET_REPLACE", "StackName": "NeptuneStack", "ChangeSetName": "NeptuneChangeSet"}}]}], "ArtifactStore": {"Type": "S3", "Location": "my-artifact-bucket"}}}}}