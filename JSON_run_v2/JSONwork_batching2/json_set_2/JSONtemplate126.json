{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"MyDBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t3.medium", "Engine": "mysql", "EngineVersion": "8.0.37", "MasterUsername": {"Ref": "DBMasterUsername"}, "MasterUserPassword": {"Ref": "DBMasterUserPassword"}, "AllocatedStorage": "20", "BackupRetentionPeriod": 7, "MultiAZ": true, "PubliclyAccessible": false, "StorageType": "gp2", "DBSubnetGroupName": {"Ref": "MyDBSubnetGroup"}, "VPCSecurityGroups": [{"Ref": "DBSecurityGroup"}]}}, "MyDBReadReplica": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t3.medium", "Engine": "mysql", "SourceDBInstanceIdentifier": {"Ref": "MyDBInstance"}, "PubliclyAccessible": false, "StorageType": "gp2", "DBSubnetGroupName": {"Ref": "MyDBSubnetGroup"}, "VPCSecurityGroups": [{"Ref": "DBSecurityGroup"}]}}, "MyDBSubnetGroup": {"Type": "AWS::RDS::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for RDS DBInstance", "SubnetIds": [{"Ref": "SubnetA"}, {"Ref": "SubnetB"}]}}, "DBSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security Group for RDS DBInstance", "VpcId": {"Ref": "VPC"}, "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": "3306", "ToPort": "3306", "CidrIp": "0.0.0.0/0"}]}}}, "Parameters": {"DBMasterUsername": {"Type": "String", "Description": "The master username for the DB instance"}, "DBMasterUserPassword": {"Type": "String", "NoEcho": true, "Description": "The master password for the DB instance"}, "SubnetA": {"Type": "AWS::EC2::Subnet::Id", "Description": "Subnet A for DB subnet group"}, "SubnetB": {"Type": "AWS::EC2::Subnet::Id", "Description": "Subnet B for DB subnet group"}, "VPC": {"Type": "AWS::EC2::VPC::Id", "Description": "VPC for DB instance"}}, "Outputs": {"DBInstanceEndpoint": {"Description": "Endpoint address of the primary DB instance", "Value": {"Fn::GetAtt": ["MyDBInstance", "Endpoint.Address"]}}, "DBReadReplicaEndpoint": {"Description": "Endpoint address of the read replica", "Value": {"Fn::GetAtt": ["MyDBReadReplica", "Endpoint.Address"]}}}}