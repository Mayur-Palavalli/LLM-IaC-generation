{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template for a highly-available RDS DBInstance with a Read Replica", "Resources": {"MyDBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"AllocatedStorage": "20", "DBInstanceClass": "db.m5.large", "Engine": "mysql", "MasterUsername": {"Ref": "DBUsername"}, "MasterUserPassword": {"Fn::Sub": "{{resolve:secretsmanager:DBPassword}}"}, "DBName": "MyDatabase", "BackupRetentionPeriod": 7, "MultiAZ": true, "VPCSecurityGroups": [{"Fn::GetAtt": ["DBSecurityGroup", "GroupId"]}]}}, "MyDBReadReplica": {"Type": "AWS::RDS::DBInstance", "Properties": {"SourceDBInstanceIdentifier": {"Ref": "MyDBInstance"}, "DBInstanceClass": "db.m5.large", "Engine": "mysql", "VPCSecurityGroups": [{"Fn::GetAtt": ["DBSecurityGroup", "GroupId"]}]}}, "DBSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Enable RDS access", "VpcId": {"Ref": "VpcId"}, "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": "3306", "ToPort": "3306", "CidrIp": "0.0.0.0/0"}]}}}, "Parameters": {"DBUsername": {"Type": "String", "Description": "The database admin account username"}, "DBPassword": {"Type": "AWS::SecretsManager::Secret::String", "Description": "The ARN of the secret storing the database admin account password", "NoEcho": true}, "VpcId": {"Type": "AWS::EC2::VPC::Id", "Description": "The VPC ID to deploy the instances in"}}}