{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"MyChannel": {"Type": "AWS::IoTAnalytics::Channel", "Properties": {"ChannelName": "MyChannel", "RetentionPeriod": {"Unlimited": true}}}, "MyDatastore": {"Type": "AWS::IoTAnalytics::Datastore", "Properties": {"DatastoreName": "MyDatastore"}}, "MyPipeline": {"Type": "AWS::IoTAnalytics::Pipeline", "Properties": {"PipelineName": "MyPipeline", "PipelineActivities": [{"Channel": {"Name": "MyChannelActivity", "ChannelName": {"Ref": "MyChannel"}, "Next": "MySQLActivity"}}, {"Lambda": {"Name": "MySQLActivity", "LambdaName": "MyLambdaFunction", "BatchSize": 1, "Next": "MyDatastoreActivity"}}, {"Datastore": {"Name": "MyDatastoreActivity", "DatastoreName": {"Ref": "MyDatastore"}}}]}}, "MyDataset": {"Type": "AWS::IoTAnalytics::Dataset", "Properties": {"DatasetName": "MyDataset", "Actions": [{"ActionName": "MySQLAction", "QueryAction": {"SqlQuery": "SELECT * FROM MyDatastore", "Filters": []}}], "Triggers": [], "ContentDeliveryRules": [], "RetentionPeriod": {"Unlimited": true, "NumberOfDays": null}}}}}