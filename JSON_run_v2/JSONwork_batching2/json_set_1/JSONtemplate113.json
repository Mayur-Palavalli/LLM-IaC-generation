{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to create AWS Greengrass resources and group along with supporting AWS services.", "Resources": {"GreengrassRole": {"Type": "AWS::IAM::Role", "Properties": {"AssumeRolePolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"Service": "greengrass.amazonaws.com"}, "Action": "sts:AssumeRole"}]}, "Policies": [{"PolicyName": "GreengrassBasicExecution", "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["logs:*", "iot:*", "greengrass:*"], "Resource": "*"}]}}]}}, "GreengrassRoleAlias": {"Type": "AWS::Greengrass::RoleAlias", "Properties": {"RoleAlias": "GreengrassCoreRoleAlias", "RoleArn": {"Fn::GetAtt": ["GreengrassRole", "Arn"]}}}, "GreengrassGroup": {"Type": "AWS::Greengrass::Group", "Properties": {"Name": "MyGreengrassGroup", "InitialVersion": {"CoreDefinitionVersionArn": {"Ref": "GreengrassCoreDefinitionVersion"}}}}, "GreengrassCoreDefinition": {"Type": "AWS::Greengrass::CoreDefinition", "Properties": {"Name": "MyGreengrassCoreDefinition", "InitialVersion": {"Cores": [{"Id": "MyGreengrassCore", "CertificateArn": {"Ref": "GreengrassCoreCertificate"}, "ThingArn": {"Ref": "GreengrassCoreThing"}, "SyncShadow": true}]}}}, "GreengrassCoreDefinitionVersion": {"Type": "AWS::Greengrass::CoreDefinitionVersion", "Properties": {"CoreDefinitionId": {"Ref": "GreengrassCoreDefinition"}, "Cores": [{"Id": "MyGreengrassCore", "CertificateArn": {"Ref": "GreengrassCoreCertificate"}, "ThingArn": {"Ref": "GreengrassCoreThing"}, "SyncShadow": true}]}}, "GreengrassCoreCertificate": {"Type": "AWS::IoT::Certificate", "Properties": {"Status": "ACTIVE"}}, "GreengrassCoreThing": {"Type": "AWS::IoT::Thing", "Properties": {"ThingName": "MyGreengrassCoreThing"}}, "GreengrassCorePolicy": {"Type": "AWS::IoT::Policy", "Properties": {"PolicyName": "GreengrassCorePolicy", "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["iot:*", "greengrass:*"], "Resource": "*"}]}}}}, "Outputs": {"GreengrassGroupId": {"Description": "The ID of the Greengrass group", "Value": {"Ref": "GreengrassGroup"}, "Export": {"Name": "GreengrassGroupId"}}, "GreengrassCoreRoleArn": {"Description": "The ARN of the Greengrass role", "Value": {"Fn::GetAtt": ["GreengrassRole", "Arn"]}, "Export": {"Name": "GreengrassCoreRoleArn"}}}}