{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation Template for creating AWS PrivateLink infrastructure", "Resources": {"VPC": {"Type": "AWS::EC2::VPC", "Properties": {"CidrBlock": "10.0.0.0/16", "EnableDnsSupport": true, "EnableDnsHostnames": true, "Tags": [{"Key": "Name", "Value": "VPC-for-PrivateLink"}]}}, "Subnet": {"Type": "AWS::EC2::Subnet", "Properties": {"VpcId": {"Ref": "VPC"}, "CidrBlock": "10.0.1.0/24", "MapPublicIpOnLaunch": true, "AvailabilityZone": {"Fn::Select": [0, {"Fn::GetAZs": ""}]}, "Tags": [{"Key": "Name", "Value": "Subnet-for-PrivateLink"}]}}, "SecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"VpcId": {"Ref": "VPC"}, "GroupDescription": "Allow incoming traffic for PrivateLink", "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": 443, "ToPort": 443, "CidrIp": "0.0.0.0/0"}], "Tags": [{"Key": "Name", "Value": "SG-for-PrivateLink"}]}}, "NLB": {"Type": "AWS::ElasticLoadBalancingV2::LoadBalancer", "Properties": {"Name": "NLB-for-PrivateLink", "Subnets": [{"Ref": "Subnet"}], "Scheme": "internet-facing", "Type": "network", "Tags": [{"Key": "Name", "Value": "NLB-for-PrivateLink"}]}}, "TargetGroup": {"Type": "AWS::ElasticLoadBalancingV2::TargetGroup", "Properties": {"Name": "TG-for-PrivateLink", "VpcId": {"Ref": "VPC"}, "Port": 80, "Protocol": "HTTP", "TargetType": "instance", "HealthCheckProtocol": "HTTP", "HealthCheckPort": "80", "HealthCheckPath": "/", "Matcher": {"HttpCode": "200"}, "Tags": [{"Key": "Name", "Value": "TG-for-PrivateLink"}]}}, "VPCEndpointService": {"Type": "AWS::EC2::VPCEndpointService", "Properties": {"NetworkLoadBalancerArns": [{"Ref": "NLB"}], "AcceptanceRequired": true}}, "VPCEndpointServicePermissions": {"Type": "AWS::EC2::VPCEndpointServicePermissions", "Properties": {"ServiceId": {"Ref": "VPCEndpointService"}, "AllowedPrincipals": ["arn:aws:iam::123456789012:root"]}}}, "Outputs": {"VPCEndpointServiceId": {"Description": "VPC Endpoint Service ID", "Value": {"Ref": "VPCEndpointService"}}}}