{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"IoTAnalyticsChannel": {"Type": "AWS::IoTAnalytics::Channel", "Properties": {"ChannelName": "MyChannel", "RetentionPeriod": {"NumberOfDays": 30}}}, "IoTAnalyticsDatastore": {"Type": "AWS::IoTAnalytics::Datastore", "Properties": {"DatastoreName": "MyDatastore", "RetentionPeriod": {"NumberOfDays": 30}}}, "IoTAnalyticsPipeline": {"Type": "AWS::IoTAnalytics::Pipeline", "Properties": {"PipelineName": "MyPipeline", "PipelineActivities": [{"Channel": {"Name": "ChannelActivity", "ChannelName": {"Ref": "IoTAnalyticsChannel"}, "Next": "SqlActivity"}}, {"SelectAttributes": {"Name": "SqlActivity", "Next": "DatastoreActivity", "Attributes": ["attribute1", "attribute2"]}}, {"Datastore": {"Name": "DatastoreActivity", "DatastoreName": {"Ref": "IoTAnalyticsDatastore"}}}]}}, "IoTAnalyticsDataset": {"Type": "AWS::IoTAnalytics::Dataset", "Properties": {"DatasetName": "MyDataset", "Actions": [{"ActionName": "SqlQueryAction", "QueryAction": {"SqlQuery": "SELECT * FROM MyDatastore WHERE attribute1 = 'value1'"}}]}}}, "Outputs": {"ChannelName": {"Value": {"Ref": "IoTAnalyticsChannel"}}, "DatastoreName": {"Value": {"Ref": "IoTAnalyticsDatastore"}}, "PipelineName": {"Value": {"Ref": "IoTAnalyticsPipeline"}}, "DatasetName": {"Value": {"Ref": "IoTAnalyticsDataset"}}}}