{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to create a highly-available RDS DBInstance with a read replica", "Resources": {"DBSubnetGroup": {"Type": "AWS::RDS::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet group for the RDS DBInstance", "SubnetIds": ["subnet-xxxxxxxx", "subnet-yyyyyyyy"]}}, "DBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t2.micro", "AllocatedStorage": "20", "DBName": "mydatabase", "Engine": "mysql", "MasterUsername": "admin", "MasterUserPassword": {"Ref": "DBPasswordParameter"}, "VPCSecurityGroups": ["sg-xxxxxxxx"], "DBSubnetGroupName": {"Ref": "DBSubnetGroup"}, "MultiAZ": true, "BackupRetentionPeriod": 7}}, "ReadReplicaInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"SourceDBInstanceIdentifier": {"Ref": "DBInstance"}, "DBInstanceClass": "db.t2.micro"}, "DeletionPolicy": "Snapshot", "UpdateReplacePolicy": "Snapshot"}}, "Outputs": {"PrimaryDBInstanceEndpoint": {"Description": "The endpoint address of the primary DBInstance", "Value": {"Fn::GetAtt": ["DBInstance", "Endpoint.Address"]}}, "ReadReplicaDBInstanceEndpoint": {"Description": "The endpoint address of the read replica DBInstance", "Value": {"Fn::GetAtt": ["ReadReplicaInstance", "Endpoint.Address"]}}}, "Parameters": {"DBPasswordParameter": {"Type": "AWS::SSM::Parameter::Value<String>", "Description": "The database admin password", "Default": "/myapp/dbpassword"}}}