{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"Subnet1": {"Type": "AWS::EC2::Subnet", "Properties": {"CidrBlock": "10.0.0.0/24", "VpcId": {"Ref": "VPC"}}}, "Subnet2": {"Type": "AWS::EC2::Subnet", "Properties": {"CidrBlock": "10.0.1.0/24", "VpcId": {"Ref": "VPC"}}}, "SecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security Group for RDS", "VpcId": {"Ref": "VPC"}}}, "MyDBSubnetGroup": {"Type": "AWS::RDS::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnets for RDS DB Instance", "SubnetIds": [{"Ref": "Subnet1"}, {"Ref": "Subnet2"}]}}, "MyDBParameterGroup": {"Type": "AWS::RDS::DBParameterGroup", "Properties": {"Description": "Parameter group for RDS DB Instance", "Family": "mysql5.7"}}, "MyDatabase": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t3.medium", "AllocatedStorage": "20", "DBName": "mydatabase", "Engine": "mysql", "MasterUsername": "admin", "MasterUserPassword": {"Fn::Sub": "{{resolve:secretsmanager:DBMasterUserPassword:SecretString:password}}"}, "VPCSecurityGroups": [{"Fn::GetAtt": ["SecurityGroup", "GroupId"]}], "DBSubnetGroupName": {"Ref": "MyDBSubnetGroup"}, "DBParameterGroupName": {"Ref": "MyDBParameterGroup"}, "MultiAZ": true, "StorageType": "gp2"}}, "ReadReplica": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t3.medium", "SourceDBInstanceIdentifier": {"Ref": "MyDatabase"}, "DBSubnetGroupName": {"Ref": "MyDBSubnetGroup"}, "VPCSecurityGroups": [{"Fn::GetAtt": ["SecurityGroup", "GroupId"]}]}}}, "Parameters": {"VPC": {"Type": "AWS::EC2::VPC::Id", "Description": "The VPC ID"}}}