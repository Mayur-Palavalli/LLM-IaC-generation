{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"DateMacroFunction": {"Type": "AWS::Lambda::Function", "Properties": {"Handler": "index.lambda_handler", "Role": {"Fn::GetAtt": ["LambdaExecutionRole", "Arn"]}, "Code": {"ZipFile": "import json\nimport datetime\nfrom datetime import timedelta\n\ndef lambda_handler(event, context):\n    request_type = event.get('RequestType')\n    properties = event.get('ResourceProperties', {})\n    if request_type == 'CurrentDate':\n        return {'statusCode': 200, 'Date': datetime.datetime.utcnow().strftime('%Y-%m-%d')}\n    if request_type == 'DateMath' and 'Days' in properties:\n        days = int(properties['Days'])\n        return {'statusCode': 200, 'Date': (datetime.datetime.utcnow() + timedelta(days=days)).strftime('%Y-%m-%d')}\n    return {'statusCode': 400, 'Message': 'Invalid Request'}\n"}, "Runtime": "python3.9", "Timeout": 60}}, "LambdaExecutionRole": {"Type": "AWS::IAM::Role", "Properties": {"AssumeRolePolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}, "Policies": [{"PolicyName": "LambdaExecutionPolicy", "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents"], "Resource": "*"}]}}]}}, "DateMacro": {"Type": "AWS::CloudFormation::Macro", "Properties": {"Name": "DateMacro", "FunctionName": {"Ref": "DateMacroFunction"}, "LogGroupName": "/aws/lambda/date-macro-log"}}}}