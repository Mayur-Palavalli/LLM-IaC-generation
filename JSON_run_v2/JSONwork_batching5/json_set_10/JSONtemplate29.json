{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"DateMacroFunction": {"Type": "AWS::Lambda::Function", "Properties": {"Handler": "index.handler", "Role": {"Fn::GetAtt": ["LambdaExecutionRole", "Arn"]}, "Code": {"ZipFile": "import json\nfrom datetime import datetime, timedelta\ndef handler(event, context):\n    if 'requestType' in event:\n        request_type = event['requestType']\n        if request_type == 'GetCurrentDate':\n            return get_current_date()\n        elif request_type == 'AddDays':\n            days = event.get('days', 0)\n            return add_days(days)\ndef get_current_date():\n    current_date = datetime.utcnow().isoformat()\n    return {'currentDate': current_date}\ndef add_days(days):\n    target_date = datetime.utcnow() + timedelta(days=days)\n    return {'targetDate': target_date.isoformat()}"}, "Runtime": "python3.8", "Timeout": 30}}, "LambdaExecutionRole": {"Type": "AWS::IAM::Role", "Properties": {"AssumeRolePolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"Service": "lambda.amazonaws.com"}, "Action": "sts:AssumeRole"}]}, "Policies": [{"PolicyName": "LambdaPolicy", "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["logs:CreateLogGroup", "logs:CreateLogStream", "logs:PutLogEvents"], "Resource": "*"}]}}]}}}, "Outputs": {"DateMacroFunctionArn": {"Description": "ARN of the Date macro Lambda function", "Value": {"Fn::GetAtt": ["DateMacroFunction", "Arn"]}}}}