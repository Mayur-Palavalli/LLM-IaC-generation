{"AWSTemplateFormatVersion": "2010-09-09", "Resources": {"DynamoDBTables": {"Type": "AWS::CloudFormation::CustomResource", "Properties": {"ServiceToken": {"Fn::GetAtt": ["CFNLambda", "Arn"]}, "Tables": [{"Name": "Table1", "AttributeDefinitions": [{"AttributeName": "Id", "AttributeType": "S"}], "KeySchema": [{"AttributeName": "Id", "KeyType": "HASH"}], "ProvisionedThroughput": {"ReadCapacityUnits": 5, "WriteCapacityUnits": 5}}, {"Name": "Table2", "AttributeDefinitions": [{"AttributeName": "Id", "AttributeType": "S"}], "KeySchema": [{"AttributeName": "Id", "KeyType": "HASH"}], "ProvisionedThroughput": {"ReadCapacityUnits": 5, "WriteCapacityUnits": 5}}]}}, "CFNLambda": {"Type": "AWS::Lambda::Function", "Properties": {"Handler": "index.handler", "Role": "arn:aws:iam::123456789012:role/lambda-role", "Code": {"ZipFile": {"Fn::Join": ["\n", ["var response = require('cfn-response');", "exports.handler = function(event, context) {", "  try {", "    var AWS = require('aws-sdk');", "    var dynamodb = new AWS.DynamoDB();", "    var tables = event.ResourceProperties.Tables;", "    var createTablePromises = tables.map(function(table) {", "      var params = {", "        TableName: table.Name,", "        AttributeDefinitions: table.AttributeDefinitions,", "        KeySchema: table.KeySchema,", "        ProvisionedThroughput: table.ProvisionedThroughput", "      };", "      return dynamodb.createTable(params).promise();", "    });", "    Promise.all(createTablePromises).then(function() {", "      response.send(event, context, response.SUCCESS);", "    }).catch(function(err) {", "      console.log('Error', err);", "      response.send(event, context, response.FAILED);", "    });", "  } catch (e) {", "    console.log('Error', e);", "    response.send(event, context, response.FAILED);", "  }", "};"]]}}, "Runtime": "nodejs20.x"}}}}