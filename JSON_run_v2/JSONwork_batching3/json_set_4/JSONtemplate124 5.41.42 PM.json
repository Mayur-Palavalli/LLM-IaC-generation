{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to provision an AWS Neptune Graph Database with monitoring through AWS CloudWatch and notifications via AWS SNS.", "Resources": {"MyNeptuneDBCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBClusterIdentifier": "my-neptune-cluster", "DBSubnetGroupName": {"Ref": "NeptuneSubnetGroup"}, "VpcSecurityGroupIds": [{"Ref": "NeptuneSecurityGroup"}]}}, "MyNeptuneDBInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": "db.r5.large", "DBClusterIdentifier": {"Ref": "MyNeptuneDBCluster"}, "AvailabilityZone": "us-west-2a"}}, "NeptuneSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet Group for Neptune DB", "SubnetIds": ["subnet-12345678", "subnet-87654321"]}}, "NeptuneSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Security group for Neptune DB", "VpcId": "vpc-12345678", "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": 8182, "ToPort": 8182, "CidrIp": "0.0.0.0/0"}]}}, "DatabaseAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmDescription": "Monitor CPU Utilization", "MetricName": "CPUUtilization", "Namespace": "AWS/Neptune", "Statistic": "Average", "Period": 300, "EvaluationPeriods": 2, "Threshold": 70, "ComparisonOperator": "GreaterThanThreshold", "AlarmActions": [{"Ref": "SnsTopic"}], "Dimensions": [{"Name": "DBInstanceIdentifier", "Value": {"Ref": "MyNeptuneDBInstance"}}]}}, "SnsTopic": {"Type": "AWS::SNS::Topic", "Properties": {"TopicName": "NeptuneDBAlarmTopic"}}, "TopicPolicy": {"Type": "AWS::SNS::TopicPolicy", "Properties": {"Topics": [{"Ref": "SnsTopic"}], "PolicyDocument": {"Statement": [{"Effect": "Allow", "Principal": {"Service": "cloudwatch.amazonaws.com"}, "Action": "sns:Publish", "Resource": {"Ref": "SnsTopic"}}]}}}}, "Outputs": {"NeptuneDBClusterID": {"Description": "Neptune DB Cluster ID", "Value": {"Ref": "MyNeptuneDBCluster"}}, "NeptuneDBInstanceID": {"Description": "Neptune DB Instance ID", "Value": {"Ref": "MyNeptuneDBInstance"}}, "SNSTopicARN": {"Description": "SNS Topic ARN", "Value": {"Ref": "SnsTopic"}}}}