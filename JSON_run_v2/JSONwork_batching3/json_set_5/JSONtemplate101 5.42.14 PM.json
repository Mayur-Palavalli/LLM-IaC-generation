{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template for a load balanced, scalable sample website using an Elastic Load Balancer (ELB) attached to an Auto Scaling group, with specific ELB features enabled.", "Resources": {"MyWebAppLoadBalancer": {"Type": "AWS::ElasticLoadBalancing::LoadBalancer", "Properties": {"CrossZone": true, "LoadBalancerName": "MyWebAppELB", "Listeners": [{"LoadBalancerPort": "80", "InstancePort": "80", "Protocol": "HTTP"}], "ConnectionDrainingPolicy": {"Enabled": true, "Timeout": 300}, "AccessLoggingPolicy": {"Enabled": true, "S3BucketName": {"Ref": "WebAppLogsBucket"}, "EmitInterval": 60}, "Policies": [{"PolicyName": "ELBSecurityPolicy-2016-08", "PolicyType": "SSLNegotiationPolicyType", "Attributes": [{"Name": "Reference-Security-Policy", "Value": "ELBSecurityPolicy-2016-08"}]}], "HealthCheck": {"Target": "HTTP:80/", "HealthyThreshold": 3, "UnhealthyThreshold": 5, "Interval": 30, "Timeout": 5}}}, "WebAppAutoScalingGroup": {"Type": "AWS::AutoScaling::AutoScalingGroup", "Properties": {"VPCZoneIdentifier": ["subnet-12345678"], "LaunchConfigurationName": {"Ref": "WebAppLaunchConfiguration"}, "MinSize": "2", "MaxSize": "5", "DesiredCapacity": "3", "LoadBalancerNames": [{"Ref": "MyWebAppLoadBalancer"}], "HealthCheckType": "ELB", "HealthCheckGracePeriod": 300}}, "WebAppLaunchConfiguration": {"Type": "AWS::AutoScaling::LaunchConfiguration", "Properties": {"ImageId": "ami-0c55b159cbfafe1f0", "InstanceType": "t2.micro", "SecurityGroups": [{"Ref": "WebAppSecurityGroup"}], "UserData": {"Fn::Base64": {"Fn::Join": ["", ["#!/bin/bash -xe\n", "yum install -y httpd\n", "systemctl start httpd\n", "systemctl enable httpd\n", "echo '<h1>Welcome to My Web App</h1>' > /var/www/html/index.html\n"]]}}}}, "WebAppSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Enable HTTP access via port 80", "VpcId": "vpc-1a2b3c4d", "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": 80, "ToPort": 80, "CidrIp": "0.0.0.0/0"}]}}, "WebAppLogsBucket": {"Type": "AWS::S3::Bucket", "Properties": {"BucketName": "my-webapp-logs"}}}}