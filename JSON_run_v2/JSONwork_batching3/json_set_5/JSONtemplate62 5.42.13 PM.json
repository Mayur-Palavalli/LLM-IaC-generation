{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation Template: Amazon EC2 instance with cfn-init and cfn-signal", "Resources": {"MyEC2Instance": {"Type": "AWS::EC2::Instance", "Properties": {"InstanceType": "t2.micro", "ImageId": "ami-0abcdef1234567890", "KeyName": "YourKeyName", "SecurityGroupIds": [{"Ref": "YourSecurityGroup"}], "UserData": {"Fn::Base64": {"Fn::Sub": ["#!/bin/bash -xe\nyum update -y aws-cfn-bootstrap\n/opt/aws/bin/cfn-init -v --stack ${AWS::StackName} --resource MyEC2Instance --region ${AWS::Region}\n/opt/aws/bin/cfn-signal -e $? --stack ${AWS::StackName} --resource MyEC2Instance --region ${AWS::Region}", {}]}}}, "Metadata": {"AWS::CloudFormation::Init": {"configSets": {"InstallAndRun": ["Install", "Configure"]}, "Install": {"packages": {"yum": {"httpd": []}}, "files": {"/var/www/html/index.html": {"content": {"Fn::Sub": "Hello from ${AWS::StackName}"}, "mode": "000644", "owner": "root", "group": "root"}}, "services": {"sysvinit": {"httpd": {"enabled": "true", "ensureRunning": "true"}}}}, "Configure": {"commands": {"test_command": {"command": "echo HelloWorld"}}}}}}}, "Outputs": {"InstanceId": {"Description": "Instance Id of the newly created EC2 instance", "Value": {"Ref": "MyEC2Instance"}}}, "Parameters": {"YourSecurityGroup": {"Type": "AWS::EC2::SecurityGroup::Id", "Description": "Security Group ID"}}}