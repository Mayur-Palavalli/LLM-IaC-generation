{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to create an AWS App Runner service from an existing ECR repository.", "Parameters": {"ECRRepositoryArn": {"Type": "String", "Description": "ARN of the existing ECR repository"}, "ECRImageTag": {"Type": "String", "Default": "latest", "Description": "The tag of the Docker image in the ECR repository to deploy"}, "ServiceName": {"Type": "String", "Description": "Name for the App Runner service"}, "InstanceType": {"Type": "String", "Default": "2vCPU_4GB", "Description": "The instance configuration for the service", "AllowedValues": ["1vCPU_2GB", "2vCPU_4GB", "4vCPU_8GB"]}}, "Resources": {"AppRunnerService": {"Type": "AWS::AppRunner::Service", "Properties": {"ServiceName": {"Ref": "ServiceName"}, "SourceConfiguration": {"ImageRepository": {"ImageRepositoryType": "ECR", "ImageConfiguration": {"Port": "80"}, "ImageIdentifier": {"Fn::Join": ["", [{"Ref": "ECRRepositoryArn"}, ":", {"Ref": "ECRImageTag"}]]}}, "AutoDeploymentsEnabled": true}, "InstanceConfiguration": {"InstanceRoleArn": {"Fn::GetAtt": ["AppRunnerInstanceRole", "Arn"]}, "InstanceType": {"Ref": "InstanceType"}}}}, "AppRunnerInstanceRole": {"Type": "AWS::IAM::Role", "Properties": {"AssumeRolePolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"Service": "build.apprunner.amazonaws.com"}, "Action": "sts:AssumeRole"}]}, "Path": "/", "ManagedPolicyArns": ["arn:aws:iam::aws:policy/service-role/AWSAppRunnerServicePolicyForECRAccess"], "Policies": []}}}, "Outputs": {"ServiceUrl": {"Description": "URL of the App Runner service", "Value": {"Fn::GetAtt": ["AppRunnerService", "ServiceUrl"]}}}}