{"AWSTemplateFormatVersion": "2010-09-09", "Description": "Highly-available RDS DBInstance with a read replica.", "Resources": {"MyDBInstance": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t3.micro", "Engine": "mysql", "MasterUsername": {"Fn::Sub": "{{resolve:ssm-secure:/application/DBUsername:1}}"}, "MasterUserPassword": {"Fn::Sub": "{{resolve:ssm-secure:/application/DBPassword:1}}"}, "AllocatedStorage": "20", "BackupRetentionPeriod": "7", "MultiAZ": true, "VPCSecurityGroups": [{"Ref": "DBSecurityGroup"}], "DBName": "mydatabase"}}, "MyDBReadReplica": {"Type": "AWS::RDS::DBInstance", "Properties": {"DBInstanceClass": "db.t3.micro", "Engine": "mysql", "SourceDBInstanceIdentifier": {"Ref": "MyDBInstance"}, "DBName": "mydatabase-read-replica", "VPCSecurityGroups": [{"Ref": "DBSecurityGroup"}]}}, "DBSecurityGroup": {"Type": "AWS::EC2::SecurityGroup", "Properties": {"GroupDescription": "Enable access to RDS instance", "VpcId": {"Ref": "VpcId"}, "SecurityGroupIngress": [{"IpProtocol": "tcp", "FromPort": "3306", "ToPort": "3306", "CidrIp": "0.0.0.0/0"}]}}}, "Parameters": {"VpcId": {"Type": "String", "Description": "VPC Id"}}, "Outputs": {"DBInstanceEndpoint": {"Description": "The connection endpoint for the primary RDS instance", "Value": {"Fn::GetAtt": ["MyDBInstance", "Endpoint.Address"]}}, "DBReadReplicaEndpoint": {"Description": "The connection endpoint for the RDS read replica instance", "Value": {"Fn::GetAtt": ["MyDBReadReplica", "Endpoint.Address"]}}}}