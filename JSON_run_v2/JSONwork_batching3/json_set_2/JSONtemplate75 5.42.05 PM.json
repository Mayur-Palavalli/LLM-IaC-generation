{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template for a Multi-AZ EFS with automount on EC2 instances.", "Resources": {"MyEFSFileSystem": {"Type": "AWS::EFS::FileSystem", "Properties": {"Encrypted": true, "PerformanceMode": "generalPurpose", "ThroughputMode": "bursting", "BackupPolicy": {"Status": "ENABLED"}, "FileSystemTags": [{"Key": "Name", "Value": "MyEFSFileSystem"}]}}, "MountTarget1": {"Type": "AWS::EFS::MountTarget", "Properties": {"FileSystemId": {"Ref": "MyEFSFileSystem"}, "SubnetId": {"Ref": "Subnet1"}, "SecurityGroups": ["sg-12345678"]}}, "MountTarget2": {"Type": "AWS::EFS::MountTarget", "Properties": {"FileSystemId": {"Ref": "MyEFSFileSystem"}, "SubnetId": {"Ref": "Subnet2"}, "SecurityGroups": ["sg-87654321"]}}, "EC2Instance": {"Type": "AWS::EC2::Instance", "Properties": {"InstanceType": "t2.micro", "ImageId": "ami-abcdefgh", "KeyName": "my-key-pair", "SubnetId": {"Ref": "Subnet1"}, "SecurityGroupIds": ["sg-12345678"], "UserData": {"Fn::Base64": {"Fn::Sub": ["#!/bin/bash\nyum update -y\nyum install -y amazon-efs-utils\nmount -t efs ${FileSystemId}:/ /mnt/efs\n", {"FileSystemId": {"Ref": "MyEFSFileSystem"}}]}}}}, "Subnet1": {"Type": "AWS::EC2::Subnet", "Properties": {"VpcId": {"Ref": "MyVPC"}, "AvailabilityZone": {"Fn::Select": [0, {"Fn::GetAZs": ""}]}, "CidrBlock": "10.0.1.0/24"}}, "Subnet2": {"Type": "AWS::EC2::Subnet", "Properties": {"VpcId": {"Ref": "MyVPC"}, "AvailabilityZone": {"Fn::Select": [1, {"Fn::GetAZs": ""}]}, "CidrBlock": "10.0.2.0/24"}}, "MyVPC": {"Type": "AWS::EC2::VPC", "Properties": {"CidrBlock": "10.0.0.0/16"}}}}