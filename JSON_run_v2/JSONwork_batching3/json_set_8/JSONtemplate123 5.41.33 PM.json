{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to provision an AWS Neptune Graph Database with CloudWatch monitoring and SNS notifications.", "Resources": {"NeptuneDBSubnetGroup": {"Type": "AWS::Neptune::DBSubnetGroup", "Properties": {"DBSubnetGroupDescription": "Subnet Group for Neptune DB", "SubnetIds": ["subnet-12345678", "subnet-87654321"]}}, "NeptuneDBCluster": {"Type": "AWS::Neptune::DBCluster", "Properties": {"DBSubnetGroupName": {"Ref": "NeptuneDBSubnetGroup"}, "DBClusterIdentifier": "neptune-cluster", "DBClusterParameterGroupName": "default.neptune1", "VpcSecurityGroupIds": ["sg-12345678"], "IamAuthEnabled": "false"}}, "NeptuneDBInstance": {"Type": "AWS::Neptune::DBInstance", "Properties": {"DBInstanceClass": "db.r5.large", "DBClusterIdentifier": {"Ref": "NeptuneDBCluster"}, "DBInstanceIdentifier": "neptune-instance"}}, "CloudWatchAlarm": {"Type": "AWS::CloudWatch::Alarm", "Properties": {"AlarmDescription": "Monitor Neptune CPU utilization", "Namespace": "AWS/Neptune", "MetricName": "CPUUtilization", "Statistic": "Average", "Period": 300, "EvaluationPeriods": 1, "Threshold": 80, "ComparisonOperator": "GreaterThanThreshold", "AlarmActions": [{"Ref": "SNSNotificationTopic"}], "Dimensions": [{"Name": "DBInstanceIdentifier", "Value": {"Ref": "NeptuneDBInstance"}}]}}, "SNSNotificationTopic": {"Type": "AWS::SNS::Topic", "Properties": {"DisplayName": "Neptune Notification Topic"}}, "SNSTopicPolicy": {"Type": "AWS::SNS::TopicPolicy", "Properties": {"Topics": [{"Ref": "SNSNotificationTopic"}], "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Sid": "AllowPublish", "Effect": "Allow", "Principal": {"AWS": "*"}, "Action": "sns:Publish", "Resource": {"Ref": "SNSNotificationTopic"}}]}}}}, "Outputs": {"NeptuneClusterEndpoint": {"Description": "Endpoint of the Neptune cluster", "Value": {"Fn::GetAtt": ["NeptuneDBCluster", "Endpoint"]}}, "SNSNotificationTopicARN": {"Description": "ARN of the SNS Topic", "Value": {"Ref": "SNSNotificationTopic"}}}}