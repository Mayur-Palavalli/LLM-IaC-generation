{"AWSTemplateFormatVersion": "2010-09-09", "Description": "AWS CloudFormation template to create an App Runner service from an existing ECR repository.", "Parameters": {"ECRRepositoryName": {"Type": "String", "Description": "The name of the existing ECR repository."}, "ECRRepositoryImageTag": {"Type": "String", "Description": "The image tag of the Docker image in the ECR repository to deploy.", "Default": "latest"}}, "Resources": {"AppRunnerInstanceRole": {"Type": "AWS::IAM::Role", "Properties": {"AssumeRolePolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Principal": {"Service": "build.apprunner.amazonaws.com"}, "Action": "sts:AssumeRole"}]}, "Policies": [{"PolicyName": "AppRunnerECRAccessPolicy", "PolicyDocument": {"Version": "2012-10-17", "Statement": [{"Effect": "Allow", "Action": ["ecr:BatchCheckLayerAvailability", "ecr:GetDownloadUrlForLayer", "ecr:GetRepositoryPolicy", "ecr:DescribeRepositories", "ecr:ListImages", "ecr:DescribeImages", "ecr:BatchGetImage", "logs:CreateLogStream", "logs:PutLogEvents"], "Resource": "*"}]}}]}}, "MyAppRunnerService": {"Type": "AWS::AppRunner::Service", "Properties": {"SourceConfiguration": {"ImageRepository": {"ImageIdentifier": {"Fn::Sub": "${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/${ECRRepositoryName}:${ECRRepositoryImageTag}"}, "ImageRepositoryType": "ECR", "ImageConfiguration": {"Port": "8000"}}, "AutoDeploymentsEnabled": true}, "InstanceConfiguration": {"InstanceRoleArn": {"Fn::GetAtt": ["AppRunnerInstanceRole", "Arn"]}, "Cpu": "1024", "Memory": "2 GB"}}}}, "Outputs": {"ServiceUrl": {"Description": "The URL of the App Runner service.", "Value": {"Fn::GetAtt": ["MyAppRunnerService", "ServiceUrl"]}}}}